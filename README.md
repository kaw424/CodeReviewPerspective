# CodeReviewPerspective
コードを観る視点

## 可逆性

### 「UNDO」可能な選択をする

### 最終決定などない

### 特定技術に依存しない

### アーキテクチャの可逆性

## コードの臭い

### コードの凶兆を見逃さない

### 嗅覚はリファクタリングの必要条件

### 臭いの傾向を知る

- よく見る
- 大きすぎる
- 長すぎる
- 名前が合わない

## 技術的負債

### 問題コードは「借金」である

### 問題コードとうまく付き合う方法

### 問題コードを管理する

### ＋１：コードをきれいにする意義を説明

### ＋１：問題コードの問題コードの誘因

#### 要素

- 経験不足のプログラマ
- 締め切りのフレッシャー
- 読みにくいコード
- 特殊化されたコード
- 不要に複雑なコード
- 単に悪い設計

#### チームの文化

- きれいなコードを書こうとしない
- 不明瞭なコードがあっても受け入れてしまう
- リファクタリングに時間を割かない
- リリース直前になって回帰テストを実行する
- 膨大な依存性を抱えた古いシステムのリプレースを躊躇する
- 安易にコードをブランチさせる

### 関連：技術的病気

「病気のソフトウェア」
→ 変更すると、関連のない別の箇所が壊れてしまう状態
    放っておいても治らずに悪化するばかり
    → 「手術」（リファクタリング）を行う必要がある。

#### リファクタリング

- 時間と労力はかかるが、PJが進む中で、その投資は十分回収できる（むしろ何倍もの利益となる）
- メンバーの経験にもなる
  - 「あるべき」を学べるので、エキスパートになっていく
- ただし、改良はゆっくり少しずつ行い、都度テストする
  - 一度に大幅な変更を加えると、それが元で大変な問題が発生することがある
    - 最悪「全部切り戻し」もあり得る。。。

### 関連： 暫定ソリューション

よくある「暫定対応」

急ぎでやるので本来守るべき規約やガイドラインに従うことができていないことが多い
→ 「あとで直す」という前提で進めているところが多いはず

ところが、暫定ソリューションには「慣性の法則」が働く（既成事実と化す）
下記理由で「直す必要性」を感じられず今すぐ変えようと動き出さず、
結果「その場しのぎ」のはずのコードが長生きする

- 今動いている
- 一応役になっている
- 一応みんなに認められている

とはいえ暫定ソリューションを初めから一切作らない、というのは現実的に無理
（問題解決間に合わない、とかどうしても起きる）

→ 技術的負債と同様に管理してあげて、原則「素早く直す」こと
（障害とかが発生した直後が一番。担当者離任とかのリスクもあるし）
